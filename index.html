<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>12 - STEM-G FPL Digital Magazine</title>
</head>

<body>
  <main>
    <div class="flipbook">
      <div>
        <img src="images/1-large.jpg" alt="">
      </div>
      <div>
        <img src="images/2-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/3-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/4-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/5-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/6-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/7-large.jpg" alt="" />
      </div>
      <div>
        <img src="images/8-large.jpg" alt="" />
      </div>
    </div>
  </main>
  
  <script src="jquery.js"></script>
  <script src="turn4.js"></script>
  <script>  
    let current_height = 0
    let current_width = 0
    function set_current_viewport() {
      // https://stackoverflow.com/questions/1248081/how-to-get-the-browser-viewport-dimensions
      current_height = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0)
      current_width = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0)
    }

    function is_viewport_landscape(){
      return current_width > current_height
    }

    function get_magazine_width(is_double_display){
      const original_width = 707
      const original_height = 1000
      const new_width = current_height * original_width / original_height

      return new_width * (1 + is_double_display)
    }

    window.addEventListener("resize", () => {
      set_current_viewport()
      let display_type = is_viewport_landscape()
      let new_width = get_magazine_width(display_type)
      $(".flipbook").turn("display", display_type  ? "double" : "single");
      $(".flipbook").turn("size", new_width, current_height);
    })

    // 
    set_current_viewport()
    let display_type = is_viewport_landscape()
    let magazine_height = current_height
    let magazine_width = get_magazine_width(display_type)
    $(".flipbook").turn({
      display: display_type  ? "double" : "single",
      width: magazine_width,
      height: magazine_height,
      inclination: 100,
      autoCenter: true,
      duration: 1000,
    });
  </script>
</body>

</html>